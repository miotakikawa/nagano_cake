<div class="container">
 <div class="alert alert-dark col-5 d-flex" role="alert">
    <strong>注文履歴詳細</strong>
 </div>
</div>

<table>
 <tr>
  <td>購入者</td>
  <td><%= link_to @order.customer.name, admin_customer_path(@order.customer_id) %></td>
 </tr>
 <tr>
  <td>注文日</td>
  <td><%= @order.created_at.strftime('%Y/%m/%d') %></td>
  </tr>
 <tr>
  <td>配送先</td>
  <td><%= @order.full_address %></td>
 </tr>
 <tr>
  <td>支払方法</td>
  <td><%= @order.payment_method_i18n %></td>
 </tr>
 <tr>
  <td>注文ステータス</td>
  <td><%= form_with model: @order, url: admin_order_path do |f| %>
      <%= f.select :status,  {'入金待ち': 0, '入金確認': 1, '製作中':2, '発送準備中': 3, '発送済み': 4 }, class: 'sample' %>
      <%= f.submit "編集", class:'btn btn-success' %>
      <% end %>
  </td>
 </tr>
 </table></br></br>


 <table border="1" width="60%">
 <tr>
   <th bgcolor="silver">商品</th>
   <th bgcolor="silver">単価(税込)</th>
   <th bgcolor="silver">個数</th>
   <th bgcolor="silver">小計</th>
   <th bgcolor="silver">製作ステータス</th>
 </tr>
 <% @order.order_details.each do |order_detail| %>
 <tr>
   <td><%= order_detail.item.name %></td>
   <td><%= (order_detail.price * 1.1).floor %></td>
   <td><%= order_detail.amount %></td>
   <td><%= (order_detail.item.price * 1.1).floor * (order_detail.amount) %></td>
   <% @total= @total+(order_detail.item.price * 1.1).floor * (order_detail.amount) %>
   <td>
     <%= form_with model: order_detail, url: admin_order_detail_path do |f| %>
     <%= f.select :making_status, {'製作待ち':0, '製作不可':1, '製作中':2, '製作完了':3}, class: 'sample' %>
     <%= f.submit "編集", class:'btn btn-success' %>
     <% end %></td>
 </tr>
 <% end %>
</table><br>

<table border="1">
 <tr>
  <td bgcolor="silver">商品合計</td>
  <td><%= @order.total_payment %></td>
 </tr>
 <tr>
  <td bgcolor="silver">配送料</td>
  <td><%= @order.shopping_cost %></td>
 </tr>
 <tr>
  <td bgcolor="silver">ご請求額</td>
  <td><%= @order.shopping_cost+@order.total_payment %></td>
 </tr>
 </table></br></br>